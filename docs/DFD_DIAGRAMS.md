# Pabbly Chatflow Mobile App - Data Flow Diagrams (DFD)

---

# DFD LEVEL 0: CONTEXT DIAGRAM

**Ye sabse high-level view hai - poora system ek circle mein**

```
                                    ┌─────────────────────┐
                                    │                     │
                                    │   WHATSAPP USER     │
                                    │   (Customer)        │
                                    │                     │
                                    └──────────┬──────────┘
                                               │
                                               │ WhatsApp Messages
                                               ▼
┌─────────────────────┐            ┌─────────────────────────────────────────┐
│                     │            │                                         │
│   PABBLY ACCOUNTS   │◄──────────►│                                         │
│   (Login Server)    │  Auth      │                                         │
│                     │            │         PABBLY CHATFLOW                 │
└─────────────────────┘            │              SYSTEM                     │
                                   │                                         │
┌─────────────────────┐            │           (Mobile App                   │
│                     │            │              +                          │
│   GOOGLE OAUTH      │◄──────────►│            Server)                      │
│                     │  Auth      │                                         │
│                     │            │                                         │
└─────────────────────┘            └──────────────────┬──────────────────────┘
                                                      │
                                                      │ Chats, Messages,
                                                      │ Notifications
                                                      ▼
                                   ┌─────────────────────────────────────────┐
                                   │                                         │
                                   │           TEAM MEMBERS                  │
                                   │         (Mobile App Users)              │
                                   │                                         │
                                   │    ┌─────┐  ┌─────┐  ┌─────┐  ┌─────┐  │
                                   │    │User1│  │User2│  │User3│  │ ... │  │
                                   │    └─────┘  └─────┘  └─────┘  └─────┘  │
                                   │                                         │
                                   └─────────────────────────────────────────┘
```

**Data Flows:**
| From | To | Data |
|------|-----|------|
| WhatsApp User | System | Messages, Media, Location |
| System | WhatsApp User | Replies, Templates, Media |
| Pabbly Accounts | System | Auth Token, User Profile |
| Google OAuth | System | OAuth Token |
| System | Team Members | Chats, Messages, Notifications |
| Team Members | System | Replies, Actions, Commands |

---

# DFD LEVEL 1: SYSTEM DECOMPOSITION

**System ko 6 main processes mein divide kiya**

```
┌──────────────────────────────────────────────────────────────────────────────────────────┐
│                                                                                          │
│                              PABBLY CHATFLOW SYSTEM                                      │
│                                                                                          │
├──────────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                          │
│                                                                                          │
│    ┌────────────────────┐          ┌────────────────────┐          ┌─────────────────┐  │
│    │                    │          │                    │          │                 │  │
│    │   P1: AUTHENTICATE │          │   P2: MANAGE       │          │  P3: MANAGE     │  │
│    │       USER         │          │       CHATS        │          │     CONTACTS    │  │
│    │                    │          │                    │          │                 │  │
│    └─────────┬──────────┘          └─────────┬──────────┘          └────────┬────────┘  │
│              │                               │                              │           │
│              │                               │                              │           │
│              ▼                               ▼                              ▼           │
│    ┌─────────────────────────────────────────────────────────────────────────────────┐  │
│    │                                                                                 │  │
│    │                            D1: REDUX STORE                                      │  │
│    │                         (In-Memory Data Store)                                  │  │
│    │                                                                                 │  │
│    │   ┌──────────┐  ┌──────────┐  ┌──────────┐  ┌──────────┐  ┌──────────┐        │  │
│    │   │userSlice │  │inboxSlice│  │contactSlice│ │templateSlice│ │settingsSlice│   │  │
│    │   └──────────┘  └──────────┘  └──────────┘  └──────────┘  └──────────┘        │  │
│    │                                                                                 │  │
│    └─────────────────────────────────────────────────────────────────────────────────┘  │
│              │                               │                              │           │
│              │                               │                              │           │
│              ▼                               ▼                              ▼           │
│    ┌────────────────────┐          ┌────────────────────┐          ┌─────────────────┐  │
│    │                    │          │                    │          │                 │  │
│    │   P4: SYNC         │          │   P5: MANAGE       │          │  P6: HANDLE     │  │
│    │       REALTIME     │          │       TEMPLATES    │          │     OFFLINE     │  │
│    │                    │          │                    │          │                 │  │
│    └─────────┬──────────┘          └─────────┬──────────┘          └────────┬────────┘  │
│              │                               │                              │           │
│              │                               │                              │           │
│              ▼                               ▼                              ▼           │
│    ┌─────────────────────────────────────────────────────────────────────────────────┐  │
│    │                                                                                 │  │
│    │                           D2: SQLite DATABASE                                   │  │
│    │                          (Persistent Local Cache)                               │  │
│    │                                                                                 │  │
│    │   ┌──────────┐  ┌──────────┐  ┌──────────┐  ┌──────────┐  ┌──────────┐        │  │
│    │   │  chats   │  │ messages │  │ contacts │  │ templates│  │cache_meta│        │  │
│    │   └──────────┘  └──────────┘  └──────────┘  └──────────┘  └──────────┘        │  │
│    │                                                                                 │  │
│    └─────────────────────────────────────────────────────────────────────────────────┘  │
│                                                                                          │
│              │                               │                              │           │
│              │                               │                              │           │
│              ▼                               ▼                              ▼           │
│    ┌─────────────────────────────────────────────────────────────────────────────────┐  │
│    │                                                                                 │  │
│    │                          D3: ASYNC STORAGE                                      │  │
│    │                         (Session & Preferences)                                 │  │
│    │                                                                                 │  │
│    │   ┌──────────┐  ┌──────────┐  ┌──────────┐  ┌──────────┐                       │  │
│    │   │  token   │  │   user   │  │ settingId│  │  prefs   │                       │  │
│    │   └──────────┘  └──────────┘  └──────────┘  └──────────┘                       │  │
│    │                                                                                 │  │
│    └─────────────────────────────────────────────────────────────────────────────────┘  │
│                                                                                          │
└──────────────────────────────────────────────────────────────────────────────────────────┘
                                          │
                                          │
                                          ▼
                    ┌─────────────────────────────────────────┐
                    │                                         │
                    │         PABBLY CHATFLOW SERVER          │
                    │                                         │
                    │  ┌─────────┐  ┌─────────┐  ┌─────────┐ │
                    │  │REST API │  │Socket.IO│  │  Push   │ │
                    │  └─────────┘  └─────────┘  └─────────┘ │
                    │                                         │
                    └─────────────────────────────────────────┘
```

**Process Descriptions:**

| Process | Name | Function |
|---------|------|----------|
| P1 | Authenticate User | Login, Logout, Session Management |
| P2 | Manage Chats | Load chats, Send/Receive messages |
| P3 | Manage Contacts | CRUD operations on contacts |
| P4 | Sync Realtime | Socket connection, Live updates |
| P5 | Manage Templates | WhatsApp template management |
| P6 | Handle Offline | Cache management, Sync queue |

---

# DFD LEVEL 2: AUTHENTICATION PROCESS (P1)

```
┌──────────────────────────────────────────────────────────────────────────────────────────┐
│                                                                                          │
│                              P1: AUTHENTICATE USER                                       │
│                                                                                          │
├──────────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                          │
│                                                                                          │
│     ┌──────────┐                                                                         │
│     │          │                                                                         │
│     │   USER   │                                                                         │
│     │          │                                                                         │
│     └────┬─────┘                                                                         │
│          │                                                                               │
│          │ Email + Password                                                              │
│          │ OR Google Token                                                               │
│          ▼                                                                               │
│     ┌─────────────────┐                                                                  │
│     │                 │                                                                  │
│     │  P1.1: VALIDATE │         Invalid                                                  │
│     │  INPUT          │─────────────────────────────► Error Message                      │
│     │                 │                                                                  │
│     └────────┬────────┘                                                                  │
│              │                                                                           │
│              │ Valid Input                                                               │
│              ▼                                                                           │
│     ┌─────────────────┐              ┌─────────────────┐                                │
│     │                 │              │                 │                                │
│     │  P1.2: AUTH     │◄────────────►│ PABBLY ACCOUNTS │                                │
│     │  WITH PABBLY    │   Token      │ SERVER          │                                │
│     │                 │              │                 │                                │
│     └────────┬────────┘              └─────────────────┘                                │
│              │                                                                           │
│              │ Pabbly Token                                                              │
│              ▼                                                                           │
│     ┌─────────────────┐              ┌─────────────────┐                                │
│     │                 │              │                 │                                │
│     │  P1.3: EXCHANGE │◄────────────►│ CHATFLOW        │                                │
│     │  TOKEN          │   JWT Token  │ SERVER          │                                │
│     │                 │   + User     │ /auth/tauth     │                                │
│     └────────┬────────┘              └─────────────────┘                                │
│              │                                                                           │
│              │ JWT + User Data + SettingId                                               │
│              ▼                                                                           │
│     ┌─────────────────┐              ┌─────────────────┐                                │
│     │                 │              │                 │                                │
│     │  P1.4: STORE    │─────────────►│ D3: ASYNC       │                                │
│     │  SESSION        │   Save       │ STORAGE         │                                │
│     │                 │   Token      │                 │                                │
│     └────────┬────────┘              └─────────────────┘                                │
│              │                                                                           │
│              │ Dispatch                                                                  │
│              ▼                                                                           │
│     ┌─────────────────┐              ┌─────────────────┐                                │
│     │                 │              │                 │                                │
│     │  P1.5: UPDATE   │─────────────►│ D1: REDUX       │                                │
│     │  REDUX STATE    │   Update     │ userSlice       │                                │
│     │                 │   State      │                 │                                │
│     └────────┬────────┘              └─────────────────┘                                │
│              │                                                                           │
│              │ authenticated = true                                                      │
│              ▼                                                                           │
│     ┌─────────────────┐                                                                  │
│     │                 │                                                                  │
│     │  NAVIGATE TO    │                                                                  │
│     │  HOME SCREEN    │                                                                  │
│     │                 │                                                                  │
│     └─────────────────┘                                                                  │
│                                                                                          │
└──────────────────────────────────────────────────────────────────────────────────────────┘
```

---

# DFD LEVEL 2: CHAT MANAGEMENT PROCESS (P2)

```
┌──────────────────────────────────────────────────────────────────────────────────────────┐
│                                                                                          │
│                              P2: MANAGE CHATS                                            │
│                                                                                          │
├──────────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                          │
│                                                                                          │
│                              ┌──────────────────┐                                        │
│                              │                  │                                        │
│                              │  USER OPENS      │                                        │
│                              │  INBOX SCREEN    │                                        │
│                              │                  │                                        │
│                              └────────┬─────────┘                                        │
│                                       │                                                  │
│                                       ▼                                                  │
│                              ┌──────────────────┐                                        │
│                              │                  │                                        │
│                              │  P2.1: CHECK     │                                        │
│                              │  LOCAL CACHE     │                                        │
│                              │                  │                                        │
│                              └────────┬─────────┘                                        │
│                                       │                                                  │
│                    ┌──────────────────┼──────────────────┐                              │
│                    │                  │                  │                              │
│                    ▼                  │                  ▼                              │
│           ┌──────────────┐            │         ┌──────────────┐                        │
│           │              │            │         │              │                        │
│           │ D2: SQLite   │            │         │ CHATFLOW     │                        │
│           │ (Cache)      │            │         │ SERVER       │                        │
│           │              │            │         │ GET /chats   │                        │
│           └──────┬───────┘            │         └──────┬───────┘                        │
│                  │                    │                │                                │
│                  │ Cached Chats       │                │ Fresh Chats                    │
│                  │                    │                │                                │
│                  └────────────────────┼────────────────┘                                │
│                                       │                                                  │
│                                       ▼                                                  │
│                              ┌──────────────────┐                                        │
│                              │                  │                                        │
│                              │  P2.2: MERGE &   │                                        │
│                              │  NORMALIZE DATA  │                                        │
│                              │                  │                                        │
│                              └────────┬─────────┘                                        │
│                                       │                                                  │
│                                       ▼                                                  │
│                              ┌──────────────────┐         ┌──────────────────┐          │
│                              │                  │         │                  │          │
│                              │  P2.3: UPDATE    │────────►│  D1: REDUX       │          │
│                              │  REDUX STORE     │         │  inboxSlice      │          │
│                              │                  │         │  state.chats     │          │
│                              └────────┬─────────┘         └──────────────────┘          │
│                                       │                                                  │
│                                       │ User Selects Chat                                │
│                                       ▼                                                  │
│                              ┌──────────────────┐         ┌──────────────────┐          │
│                              │                  │         │                  │          │
│                              │  P2.4: LOAD      │◄───────►│  CHATFLOW        │          │
│                              │  CONVERSATION    │         │  SERVER          │          │
│                              │                  │         │  /fetchConversation│        │
│                              └────────┬─────────┘         └──────────────────┘          │
│                                       │                                                  │
│                                       │ Messages Loaded                                  │
│                                       ▼                                                  │
│                              ┌──────────────────┐                                        │
│                              │                  │                                        │
│                              │  DISPLAY CHAT    │                                        │
│                              │  MESSAGES        │                                        │
│                              │                  │                                        │
│                              └──────────────────┘                                        │
│                                                                                          │
└──────────────────────────────────────────────────────────────────────────────────────────┘
```

---

# DFD LEVEL 2: MESSAGE SENDING PROCESS

```
┌──────────────────────────────────────────────────────────────────────────────────────────┐
│                                                                                          │
│                              MESSAGE SENDING FLOW                                        │
│                                                                                          │
├──────────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                          │
│                                                                                          │
│     ┌──────────────────┐                                                                 │
│     │                  │                                                                 │
│     │  USER TYPES      │                                                                 │
│     │  MESSAGE         │                                                                 │
│     │                  │                                                                 │
│     └────────┬─────────┘                                                                 │
│              │                                                                           │
│              │ Text / Media / Template                                                   │
│              ▼                                                                           │
│     ┌──────────────────┐                                                                 │
│     │                  │                                                                 │
│     │  PRESS SEND      │                                                                 │
│     │  BUTTON          │                                                                 │
│     │                  │                                                                 │
│     └────────┬─────────┘                                                                 │
│              │                                                                           │
│              ▼                                                                           │
│     ┌──────────────────┐         ┌──────────────────┐                                   │
│     │                  │         │                  │                                   │
│     │  P: OPTIMISTIC   │────────►│  D1: REDUX       │                                   │
│     │  UPDATE          │         │  Add message     │                                   │
│     │                  │         │  status: PENDING │                                   │
│     │  (Instant UI)    │         │                  │                                   │
│     └────────┬─────────┘         └──────────────────┘                                   │
│              │                                                                           │
│              │ User sees message immediately                                             │
│              ▼                                                                           │
│     ┌──────────────────┐         ┌──────────────────┐                                   │
│     │                  │         │                  │                                   │
│     │  P: EMIT SOCKET  │────────►│  SOCKET.IO       │                                   │
│     │  EVENT           │         │  SERVER          │                                   │
│     │                  │         │  'sendMessage'   │                                   │
│     └────────┬─────────┘         └────────┬─────────┘                                   │
│              │                            │                                             │
│              │                            ▼                                             │
│              │                   ┌──────────────────┐                                   │
│              │                   │                  │                                   │
│              │                   │  SERVER          │                                   │
│              │                   │  PROCESSING      │                                   │
│              │                   │                  │                                   │
│              │                   │  1. Validate     │                                   │
│              │                   │  2. Save to DB   │                                   │
│              │                   │  3. Send to WA   │                                   │
│              │                   │                  │                                   │
│              │                   └────────┬─────────┘                                   │
│              │                            │                                             │
│              │                            ▼                                             │
│              │                   ┌──────────────────┐                                   │
│              │                   │                  │                                   │
│              │                   │  WHATSAPP        │                                   │
│              │                   │  BUSINESS API    │                                   │
│              │                   │                  │                                   │
│              │                   └────────┬─────────┘                                   │
│              │                            │                                             │
│              │                            │ Status: SENT                                │
│              │                            ▼                                             │
│              │                   ┌──────────────────┐                                   │
│              │                   │                  │                                   │
│              │◄──────────────────│  'messageStatus' │                                   │
│              │   Socket Event    │  Event Received  │                                   │
│              │                   │                  │                                   │
│              ▼                   └──────────────────┘                                   │
│     ┌──────────────────┐                                                                 │
│     │                  │                                                                 │
│     │  UPDATE MESSAGE  │                                                                 │
│     │  STATUS IN UI    │                                                                 │
│     │                  │                                                                 │
│     │  ⏳ → ✓ → ✓✓ → ✓✓│                                                                 │
│     │  Pending Sent Delivered Read                                                      │
│     │                  │                                                                 │
│     └──────────────────┘                                                                 │
│                                                                                          │
└──────────────────────────────────────────────────────────────────────────────────────────┘
```

---

# DFD LEVEL 2: MESSAGE RECEIVING PROCESS (REALTIME)

```
┌──────────────────────────────────────────────────────────────────────────────────────────┐
│                                                                                          │
│                              MESSAGE RECEIVING FLOW                                      │
│                                                                                          │
├──────────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                          │
│                                                                                          │
│     ┌──────────────────┐                                                                 │
│     │                  │                                                                 │
│     │  WHATSAPP USER   │                                                                 │
│     │  SENDS MESSAGE   │                                                                 │
│     │                  │                                                                 │
│     └────────┬─────────┘                                                                 │
│              │                                                                           │
│              ▼                                                                           │
│     ┌──────────────────┐                                                                 │
│     │                  │                                                                 │
│     │  WHATSAPP        │                                                                 │
│     │  BUSINESS API    │                                                                 │
│     │                  │                                                                 │
│     └────────┬─────────┘                                                                 │
│              │                                                                           │
│              │ Webhook                                                                   │
│              ▼                                                                           │
│     ┌──────────────────┐                                                                 │
│     │                  │                                                                 │
│     │  CHATFLOW        │                                                                 │
│     │  SERVER          │                                                                 │
│     │                  │                                                                 │
│     │  1. Receive      │                                                                 │
│     │  2. Process      │                                                                 │
│     │  3. Store in DB  │                                                                 │
│     │                  │                                                                 │
│     └────────┬─────────┘                                                                 │
│              │                                                                           │
│              │                                                                           │
│     ┌────────┴────────────────────────────┐                                             │
│     │                                     │                                             │
│     ▼                                     ▼                                             │
│  ┌──────────────────┐            ┌──────────────────┐                                   │
│  │                  │            │                  │                                   │
│  │  SOCKET.IO       │            │  PUSH            │                                   │
│  │  BROADCAST       │            │  NOTIFICATION    │                                   │
│  │  'newMessage'    │            │  SERVICE         │                                   │
│  │                  │            │                  │                                   │
│  └────────┬─────────┘            └────────┬─────────┘                                   │
│           │                               │                                             │
│           │ To all connected              │ To all registered                           │
│           │ devices                       │ devices                                     │
│           │                               │                                             │
│           ▼                               ▼                                             │
│  ┌─────────────────────────────────────────────────────────────────┐                    │
│  │                                                                 │                    │
│  │                      MOBILE APP                                 │                    │
│  │                                                                 │                    │
│  │  ┌──────────────────────────────────────────────────────────┐  │                    │
│  │  │                                                          │  │                    │
│  │  │  P: CHECK SETTING ID                                     │  │                    │
│  │  │                                                          │  │                    │
│  │  │  newChat.settingId === mySettingId ?                     │  │                    │
│  │  │                                                          │  │                    │
│  │  └─────────────────────────┬────────────────────────────────┘  │                    │
│  │                            │                                    │                    │
│  │              ┌─────────────┴─────────────┐                     │                    │
│  │              │                           │                     │                    │
│  │              ▼                           ▼                     │                    │
│  │         ┌────────┐                  ┌────────┐                 │                    │
│  │         │  YES   │                  │   NO   │                 │                    │
│  │         └───┬────┘                  └───┬────┘                 │                    │
│  │             │                           │                      │                    │
│  │             ▼                           ▼                      │                    │
│  │  ┌──────────────────┐          ┌──────────────────┐           │                    │
│  │  │                  │          │                  │           │                    │
│  │  │  PROCESS         │          │  IGNORE          │           │                    │
│  │  │  MESSAGE         │          │  MESSAGE         │           │                    │
│  │  │                  │          │                  │           │                    │
│  │  └────────┬─────────┘          └──────────────────┘           │                    │
│  │           │                                                    │                    │
│  │           ▼                                                    │                    │
│  │  ┌──────────────────┐         ┌──────────────────┐            │                    │
│  │  │                  │         │                  │            │                    │
│  │  │  UPDATE REDUX    │────────►│  D1: REDUX       │            │                    │
│  │  │  STORE           │         │  inboxSlice      │            │                    │
│  │  │                  │         │                  │            │                    │
│  │  └────────┬─────────┘         └──────────────────┘            │                    │
│  │           │                                                    │                    │
│  │           ▼                                                    │                    │
│  │  ┌──────────────────┐                                         │                    │
│  │  │                  │                                         │                    │
│  │  │  CHECK APP       │                                         │                    │
│  │  │  STATE           │                                         │                    │
│  │  │                  │                                         │                    │
│  │  └────────┬─────────┘                                         │                    │
│  │           │                                                    │                    │
│  │    ┌──────┴──────┐                                            │                    │
│  │    │             │                                            │                    │
│  │    ▼             ▼                                            │                    │
│  │ ┌───────┐   ┌────────────┐                                    │                    │
│  │ │ACTIVE │   │ BACKGROUND │                                    │                    │
│  │ │Same   │   │ OR         │                                    │                    │
│  │ │Chat   │   │ Diff Chat  │                                    │                    │
│  │ └───┬───┘   └─────┬──────┘                                    │                    │
│  │     │             │                                           │                    │
│  │     ▼             ▼                                           │                    │
│  │ ┌─────────┐  ┌──────────────┐                                 │                    │
│  │ │ NO      │  │ SHOW         │                                 │                    │
│  │ │ NOTIF   │  │ NOTIFICATION │                                 │                    │
│  │ └─────────┘  └──────────────┘                                 │                    │
│  │                                                                │                    │
│  └────────────────────────────────────────────────────────────────┘                    │
│                                                                                          │
└──────────────────────────────────────────────────────────────────────────────────────────┘
```

---

# DFD: COMPLETE DATA FLOW OVERVIEW

```
┌────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│                                                                                                        │
│                                    COMPLETE SYSTEM DATA FLOW                                           │
│                                                                                                        │
├────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                                        │
│                                                                                                        │
│   ┌─────────────┐                                              ┌─────────────┐                        │
│   │             │                                              │             │                        │
│   │  WHATSAPP   │◄────────── WhatsApp Messages ───────────────►│  WHATSAPP   │                        │
│   │    USER     │                                              │    API      │                        │
│   │             │                                              │             │                        │
│   └─────────────┘                                              └──────┬──────┘                        │
│                                                                       │                               │
│                                                                       │ Webhook                       │
│                                                                       ▼                               │
│   ┌─────────────┐      Auth Token       ┌────────────────────────────────────────────────┐            │
│   │             │◄─────────────────────►│                                                │            │
│   │   PABBLY    │                       │                                                │            │
│   │  ACCOUNTS   │                       │              CHATFLOW SERVER                   │            │
│   │             │                       │                                                │            │
│   └─────────────┘                       │  ┌──────────┐  ┌──────────┐  ┌──────────┐    │            │
│                                         │  │ REST API │  │SOCKET.IO │  │  PUSH    │    │            │
│   ┌─────────────┐      OAuth Token      │  │          │  │          │  │ SERVICE  │    │            │
│   │             │◄─────────────────────►│  └────┬─────┘  └────┬─────┘  └────┬─────┘    │            │
│   │   GOOGLE    │                       │       │             │             │          │            │
│   │    OAUTH    │                       │       │             │             │          │            │
│   │             │                       │       └─────────────┼─────────────┘          │            │
│   └─────────────┘                       │                     │                        │            │
│                                         │                     │                        │            │
│                                         │              ┌──────┴──────┐                 │            │
│                                         │              │             │                 │            │
│                                         │              │  MONGODB    │                 │            │
│                                         │              │  DATABASE   │                 │            │
│                                         │              │             │                 │            │
│                                         │              └─────────────┘                 │            │
│                                         │                                                │            │
│                                         └────────────────────┬───────────────────────────┘            │
│                                                              │                                        │
│                                                              │                                        │
│                              HTTP / WebSocket / Push         │                                        │
│                                                              │                                        │
│                                                              ▼                                        │
│   ┌──────────────────────────────────────────────────────────────────────────────────────────────┐   │
│   │                                                                                              │   │
│   │                                    MOBILE APPLICATION                                        │   │
│   │                                                                                              │   │
│   │  ┌────────────────────────────────────────────────────────────────────────────────────────┐ │   │
│   │  │                                                                                        │ │   │
│   │  │                                   UI LAYER                                             │ │   │
│   │  │                                                                                        │ │   │
│   │  │   ┌─────────┐   ┌─────────┐   ┌─────────┐   ┌─────────┐   ┌─────────┐   ┌─────────┐  │ │   │
│   │  │   │ LOGIN   │   │DASHBOARD│   │  INBOX  │   │  CHAT   │   │CONTACTS │   │SETTINGS │  │ │   │
│   │  │   │ SCREEN  │   │ SCREEN  │   │ SCREEN  │   │ DETAILS │   │ SCREEN  │   │ SCREEN  │  │ │   │
│   │  │   └─────────┘   └─────────┘   └─────────┘   └─────────┘   └─────────┘   └─────────┘  │ │   │
│   │  │                                                                                        │ │   │
│   │  └──────────────────────────────────────────┬─────────────────────────────────────────────┘ │   │
│   │                                             │                                               │   │
│   │                                             │ dispatch() / useSelector()                    │   │
│   │                                             ▼                                               │   │
│   │  ┌────────────────────────────────────────────────────────────────────────────────────────┐ │   │
│   │  │                                                                                        │ │   │
│   │  │                                  STATE LAYER                                           │ │   │
│   │  │                                                                                        │ │   │
│   │  │   ┌─────────────────────────────────────────────────────────────────────────────────┐ │ │   │
│   │  │   │                            REDUX STORE                                          │ │ │   │
│   │  │   │                                                                                 │ │ │   │
│   │  │   │  ┌────────┐ ┌────────┐ ┌────────┐ ┌────────┐ ┌────────┐ ┌────────┐            │ │ │   │
│   │  │   │  │  user  │ │ inbox  │ │contact │ │template│ │settings│ │dashboard│           │ │ │   │
│   │  │   │  │ Slice  │ │ Slice  │ │ Slice  │ │ Slice  │ │ Slice  │ │ Slice  │            │ │ │   │
│   │  │   │  └────────┘ └────────┘ └────────┘ └────────┘ └────────┘ └────────┘            │ │ │   │
│   │  │   │                                                                                 │ │ │   │
│   │  │   └─────────────────────────────────────────────────────────────────────────────────┘ │ │   │
│   │  │                                                                                        │ │   │
│   │  │   ┌────────────────┐    ┌────────────────┐    ┌────────────────┐                     │ │   │
│   │  │   │ SOCKET CONTEXT │    │ CACHE CONTEXT  │    │NETWORK CONTEXT │                     │ │   │
│   │  │   │ (Real-time)    │    │ (SQLite)       │    │ (Connectivity) │                     │ │   │
│   │  │   └────────────────┘    └────────────────┘    └────────────────┘                     │ │   │
│   │  │                                                                                        │ │   │
│   │  └──────────────────────────────────────────┬─────────────────────────────────────────────┘ │   │
│   │                                             │                                               │   │
│   │                                             │ Service Calls                                 │   │
│   │                                             ▼                                               │   │
│   │  ┌────────────────────────────────────────────────────────────────────────────────────────┐ │   │
│   │  │                                                                                        │ │   │
│   │  │                                 SERVICE LAYER                                          │ │   │
│   │  │                                                                                        │ │   │
│   │  │   ┌─────────────┐   ┌─────────────┐   ┌─────────────┐   ┌─────────────┐              │ │   │
│   │  │   │   AXIOS     │   │  SOCKET.IO  │   │  SESSION    │   │    FILE     │              │ │   │
│   │  │   │  (HTTP)     │   │  (Realtime) │   │  MANAGER    │   │   UPLOAD    │              │ │   │
│   │  │   └─────────────┘   └─────────────┘   └─────────────┘   └─────────────┘              │ │   │
│   │  │                                                                                        │ │   │
│   │  └──────────────────────────────────────────┬─────────────────────────────────────────────┘ │   │
│   │                                             │                                               │   │
│   │                                             │ Read/Write                                    │   │
│   │                                             ▼                                               │   │
│   │  ┌────────────────────────────────────────────────────────────────────────────────────────┐ │   │
│   │  │                                                                                        │ │   │
│   │  │                                  DATA LAYER                                            │ │   │
│   │  │                                                                                        │ │   │
│   │  │   ┌─────────────────────┐   ┌─────────────────────┐   ┌─────────────────────┐        │ │   │
│   │  │   │                     │   │                     │   │                     │        │ │   │
│   │  │   │    ASYNC STORAGE    │   │       SQLITE        │   │       REDUX         │        │ │   │
│   │  │   │    (Session)        │   │      (Cache)        │   │     (Memory)        │        │ │   │
│   │  │   │                     │   │                     │   │                     │        │ │   │
│   │  │   │  • token            │   │  • chats            │   │  • Current state    │        │ │   │
│   │  │   │  • user             │   │  • messages         │   │  • UI state         │        │ │   │
│   │  │   │  • settingId        │   │  • contacts         │   │  • Temp data        │        │ │   │
│   │  │   │  • preferences      │   │  • cache_metadata   │   │                     │        │ │   │
│   │  │   │                     │   │                     │   │                     │        │ │   │
│   │  │   └─────────────────────┘   └─────────────────────┘   └─────────────────────┘        │ │   │
│   │  │                                                                                        │ │   │
│   │  └────────────────────────────────────────────────────────────────────────────────────────┘ │   │
│   │                                                                                              │   │
│   └──────────────────────────────────────────────────────────────────────────────────────────────┘   │
│                                                                                                        │
└────────────────────────────────────────────────────────────────────────��───────────────────────────────┘
```

---

# DATA STORE DESCRIPTIONS

| Store | Type | Purpose | Data Stored |
|-------|------|---------|-------------|
| D1: Redux Store | In-Memory | Fast UI state | user, chats, contacts, templates, settings |
| D2: SQLite | Persistent DB | Offline cache | chats, messages, contacts, templates |
| D3: AsyncStorage | Key-Value | Session data | token, user, settingId, preferences |
| D4: MongoDB (Server) | Remote DB | Source of truth | All business data |

---

# PROCESS SUMMARY

| Process | Input | Output | Data Stores Used |
|---------|-------|--------|------------------|
| P1: Authenticate | Credentials | Token, User | D3, D1 |
| P2: Manage Chats | User actions | Chat updates | D1, D2, Server |
| P3: Manage Contacts | User actions | Contact updates | D1, D2, Server |
| P4: Sync Realtime | Socket events | UI updates | D1 |
| P5: Manage Templates | User actions | Template updates | D1, D2, Server |
| P6: Handle Offline | Cache data | Sync queue | D2 |

---

**Document Version:** 1.0.0
**Last Updated:** February 2026
